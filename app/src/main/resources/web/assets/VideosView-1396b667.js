import{d as ke,ad as ye,p as we,r as v,u as $e,s as Ve,a as Ie,A as Te,n as Ce,B as Se,C as xe,ae as Re,af as Ee,D as Ae,t as De,ag as Fe,am as Ue,G as W,H as ze,I as Me,o as a,c,b as e,e as f,w as b,Q as I,k as d,f as l,v as qe,J as F,K as Be,L as Ne,g as s,F as T,y as U,W as X,M as j,N as Le,x as Qe,ab as J,l as Ke,z as P,R as Y,a6 as Ge,aj as He,ak as Oe,al as We,ai as Xe,_ as je}from"./index-400f4a7b.js";import{u as Je,_ as Pe,a as Ye}from"./list-347696d3.js";import{_ as Ze}from"./FieldId-439f3700.js";import{_ as et}from"./Multiselect-63456c80.js";import{_ as tt}from"./Dropdown.vuevuetypescriptsetuptruelang-24c50f04.js";import{_ as ot,a as st}from"./grid-view-outline-rounded-f695eedf.js";import{_ as nt}from"./Breadcrumb-7c24ea6b.js";import{n as Z}from"./list-6498ebd9.js";import{b as at,a as lt}from"./search-e9047456.js";import{u as it,a as ct,b as ut}from"./tags-f1a271ba.js";import{u as dt,a as rt,_ as _t}from"./ConfirmModal.vuevuetypescriptsetuptruelang-a3aed113.js";import"./VModal.vuevuetypescriptsetuptruelang-610de861.js";import"./baseIndexOf-70b929c6.js";import"./vee-validate.esm-5d9cc34a.js";const ee=k=>(Oe("data-v-5f6375ce"),k=k(),We(),k),pt={class:"v-toolbar"},mt={class:"right-actions"},vt=["onClick"],ht=["onClick"],gt={class:"row mb-3"},ft={class:"col-md-3 col-form-label"},bt={class:"col-md-9"},kt=["onKeyup"],yt={class:"row mb-3"},wt={class:"col-md-3 col-form-label"},$t={class:"col-md-9"},Vt={class:"actions"},It=["onClick"],Tt={key:0,class:"row row-cols-6 g-1",style:{"margin-bottom":"24px"}},Ct=["onClick"],St=["src"],xt={class:"duration"},Rt={key:1,class:"no-data-placeholder"},Et={key:2,class:"table"},At=ee(()=>e("th",null,"ID",-1)),Dt=ee(()=>e("th",null,null,-1)),Ft=["onClick"],Ut=["onUpdate:modelValue"],zt=["src","onClick"],Mt={class:"badge"},qt={key:0},Bt={colspan:"7"},Nt={class:"no-data-placeholder"},Lt=ke({__name:"VideosView",setup(k){var G,H,O;const te=ye(),z=we(),u=v([]),{t:r}=$e(),{app:C}=Ve(Ie()),_=Te({text:"",tags:[]}),h="VIDEO",S=Ce().query,g=v(parseInt(((G=S.page)==null?void 0:G.toString())??"1")),y=54,w=v(0),p=v(Se(((H=S.q)==null?void 0:H.toString())??"")),M=v(""),{tags:x}=it(h,p,_,async o=>{M.value=at(o),await xe(),de()}),i=v(((O=S.view)==null?void 0:O.toString())??"grid"),{visible:oe,index:se,view:q,hide:ne}=Re(),{addToTags:ae}=ct(h,u,x),{removeFromTags:le}=ut(h,u,x),{deleteItems:ie}=dt(h,u),{downloadItems:ce}=rt(u),R=Ee(()=>u.value.map(o=>({src:J(o.fileId),name:Xe(o.path),duration:o.duration,size:o.size}))),ue=[{text:r("add_to_tags"),click:ae},{text:r("remove_from_tags"),click:le},{text:r("download"),click:ce},{text:r("delete"),click:ie}],{selectAll:E,toggleSelect:B}=Je(u),{loading:N,load:de,refetch:re}=Ae({handle:async(o,n)=>{if(n)De(r(n),"error");else if(o){const{fileIdToken:A}=C.value,$=[];for(const V of o.videos)$.push({...V,checked:!1,fileId:await Fe(A,V.path)});u.value=$,w.value=o.videoCount}},document:Ue,variables:()=>({offset:(g.value-1)*y,limit:y,query:M.value}),appApi:!0});function L(){P(z,`/videos?page=${g.value}&q=${Y(p.value)}&view=${i.value}`)}W(g,()=>{L()}),W(i,()=>{L()});function Q(){p.value=lt(_),K()}function K(){P(z,`/videos?q=${Y(p.value)}&view=${i.value}`)}function _e(){i.value==="grid"?i.value="list":i.value="grid"}function pe(){te.push("/files"),Ge(_t,{message:r("upload_videos")})}return ze(()=>{Me.on("refetch_by_tag_type",o=>{o===h&&re()})}),(o,n)=>{const A=nt,$=ot,V=st,me=tt,ve=et,he=Pe,ge=Ze,fe=Ye,be=He;return a(),c(T,null,[e("div",pt,[f(A,{current:()=>`${o.$t("page_title.videos")} (${w.value})`},null,8,["current"]),e("div",mt,[e("button",{type:"button",class:"btn btn-action",onClick:b(_e,["prevent"])},[i.value==="list"?(a(),I($,{key:0,class:"bi"})):d("",!0),i.value==="grid"?(a(),I(V,{key:1,class:"bi"})):d("",!0)],8,vt),e("button",{type:"button",class:"btn btn-action",onClick:b(pe,["prevent"])},l(o.$t("upload")),9,ht),i.value==="list"?(a(),I(me,{key:0,title:o.$t("actions"),items:ue},null,8,["title"])):d("",!0),f(he,{modelValue:p.value,"onUpdate:modelValue":n[2]||(n[2]=t=>p.value=t),search:K},{filters:qe(()=>[e("div",gt,[e("label",ft,l(o.$t("keywords")),1),e("div",bt,[F(e("input",{type:"text","onUpdate:modelValue":n[0]||(n[0]=t=>_.text=t),class:"form-control",onKeyup:Ne(Q,["enter"])},null,40,kt),[[Be,_.text]])])]),e("div",yt,[e("label",wt,l(o.$t("tags")),1),e("div",$t,[f(ve,{modelValue:_.tags,"onUpdate:modelValue":n[1]||(n[1]=t=>_.tags=t),label:"name","track-by":"id",options:s(x)},null,8,["modelValue","options"])])]),e("div",Vt,[e("button",{type:"button",class:"btn",onClick:b(Q,["stop"])},l(o.$t("search")),9,It)])]),_:1},8,["modelValue"])])]),i.value==="grid"?(a(),c("div",Tt,[(a(!0),c(T,null,U(s(R),(t,D)=>(a(),c("div",{class:"col",onClick:m=>s(q)(D)},[e("img",{class:"image",src:t.src+"&w=200&h=200"},null,8,St),e("span",xt,l(s(X)(t.duration)),1)],8,Ct))),256))])):d("",!0),i.value==="grid"&&s(R).length===0?(a(),c("div",Rt,l(o.$t(s(Z)(s(N),s(C).permissions,"WRITE_EXTERNAL_STORAGE"))),1)):d("",!0),i.value==="list"?(a(),c("table",Et,[e("thead",null,[e("tr",null,[e("th",null,[F(e("input",{class:"form-check-input",type:"checkbox",onChange:n[3]||(n[3]=(...t)=>s(B)&&s(B)(...t)),"onUpdate:modelValue":n[4]||(n[4]=t=>Le(E)?E.value=t:null)},null,544),[[j,s(E)]])]),At,Dt,e("th",null,l(o.$t("name")),1),e("th",null,l(o.$t("tags")),1),e("th",null,l(o.$t("duration")),1),e("th",null,l(o.$t("file_size")),1)])]),e("tbody",null,[(a(!0),c(T,null,U(u.value,(t,D)=>(a(),c("tr",{key:t.id,class:Qe({checked:t.checked}),onClick:b(m=>t.checked=!t.checked,["stop"])},[e("td",null,[F(e("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":m=>t.checked=m},null,8,Ut),[[j,t.checked]])]),e("td",null,[f(ge,{id:t.id,raw:t},null,8,["id","raw"])]),e("td",null,[e("img",{class:"img-video",src:s(J)(t.fileId)+"&w=200&h=200",width:"50",height:"50",onClick:b(m=>s(q)(D),["stop"])},null,8,zt)]),e("td",null,l(t.title),1),e("td",null,[(a(!0),c(T,null,U(t.tags,m=>(a(),c("span",Mt,l(m.name),1))),256))]),e("td",null,l(s(X)(t.duration)),1),e("td",null,l(s(Ke)(t.size)),1)],10,Ft))),128))]),u.value.length?d("",!0):(a(),c("tfoot",qt,[e("tr",null,[e("td",Bt,[e("div",Nt,l(o.$t(s(Z)(s(N),s(C).permissions,"WRITE_EXTERNAL_STORAGE"))),1)])])]))])):d("",!0),w.value>y?(a(),I(fe,{key:3,modelValue:g.value,"onUpdate:modelValue":n[5]||(n[5]=t=>g.value=t),total:w.value,limit:y},null,8,["modelValue","total"])):d("",!0),f(be,{visible:s(oe),index:s(se),sources:s(R),onHide:s(ne)},null,8,["visible","index","sources","onHide"])],64)}}});const so=je(Lt,[["__scopeId","data-v-5f6375ce"]]);export{so as default};
