import{d as be,ab as ke,n as ye,r as m,u as we,y as $e,z as Ve,A as Te,m as Ce,B as Ie,C as Se,ac as Re,ad as xe,D as Ee,t as Ae,ae as Fe,ak as Ue,G as W,H as qe,I as ze,o as a,c,a as e,b as f,w as b,Q as T,g as d,e as l,q as De,J as U,K as Me,L as Be,j as o,F as C,v as q,W as j,M as X,N as Ne,s as Le,a9 as J,k as Qe,x as P,R as Y,a4 as Ke,ah as Ge,ai as He,aj as Oe,ag as We,_ as je}from"./index-89decb33.js";import{u as Xe,a as Je,b as Pe,c as Ye,_ as Ze,d as et}from"./list-e7ef4cf1.js";import{_ as tt}from"./FieldId-da304ce7.js";import{_ as st}from"./Multiselect-90c04a89.js";import{_ as ot}from"./Dropdown.vuevuetypescriptsetuptruelang-172ac0f4.js";import{_ as nt,a as at}from"./grid-view-outline-rounded-e266e766.js";import{_ as lt}from"./Breadcrumb-23f5606f.js";import{n as Z}from"./list-6498ebd9.js";import{b as it,a as ct}from"./search-0684184d.js";import{u as ut,_ as dt}from"./ConfirmModal.vuevuetypescriptsetuptruelang-57180c2e.js";import"./VModal.vuevuetypescriptsetuptruelang-6d140002.js";import"./vee-validate.esm-09f61400.js";import"./baseIndexOf-70b929c6.js";const ee=k=>(He("data-v-607dc250"),k=k(),Oe(),k),rt={class:"v-toolbar"},_t={class:"right-actions"},pt=["onClick"],mt=["onClick"],vt={class:"row mb-3"},ht={class:"col-md-3 col-form-label"},gt={class:"col-md-9"},ft=["onKeyup"],bt={class:"row mb-3"},kt={class:"col-md-3 col-form-label"},yt={class:"col-md-9"},wt={class:"actions"},$t=["onClick"],Vt={key:0,class:"row row-cols-6 g-1",style:{"margin-bottom":"24px"}},Tt=["onClick"],Ct=["src"],It={class:"duration"},St={key:1,class:"no-data-placeholder"},Rt={key:2,class:"table"},xt=ee(()=>e("th",null,"ID",-1)),Et=ee(()=>e("th",null,null,-1)),At=["onClick"],Ft=["onUpdate:modelValue"],Ut=["src","onClick"],qt={class:"badge"},zt={key:0},Dt={colspan:"7"},Mt={class:"no-data-placeholder"},Bt=be({__name:"VideosView",setup(k){var G,H,O;const te=ke(),z=ye(),u=m([]),{t:v}=we(),{app:I}=$e(Ve()),r=Te({text:"",tags:[]}),h="VIDEO",S=Ce().query,g=m(parseInt(((G=S.page)==null?void 0:G.toString())??"1")),y=54,w=m(0),_=m(Ie(((H=S.q)==null?void 0:H.toString())??"")),D=m(""),{tags:R}=Xe(h,_,r,async s=>{D.value=it(s),await Se(),ue()}),i=m(((O=S.view)==null?void 0:O.toString())??"grid"),{visible:se,index:oe,view:M,hide:ne}=Re(),{addToTags:ae}=Je(h,u,R),{removeFromTags:le}=Pe(h,u,R),{deleteItems:ie}=ut(h,u),x=xe(()=>u.value.map(s=>({src:J(s.fileId),name:We(s.path),duration:s.duration,size:s.size}))),ce=[{text:v("add_to_tags"),click:ae},{text:v("remove_from_tags"),click:le},{text:v("delete"),click:ie}],{selectAll:E,toggleSelect:B}=Ye(u),{loading:N,load:ue,refetch:de}=Ee({handle:async(s,n)=>{if(n)Ae(v(n),"error");else if(s){const{fileIdToken:A}=I.value,$=[];for(const V of s.videos)$.push({...V,checked:!1,fileId:await Fe(A,V.path)});u.value=$,w.value=s.videoCount}},document:Ue,variables:()=>({offset:(g.value-1)*y,limit:y,query:D.value}),appApi:!0});function L(){P(z,`/videos?page=${g.value}&q=${Y(_.value)}&view=${i.value}`)}W(g,()=>{L()}),W(i,()=>{L()});function Q(){_.value=ct(r),K()}function K(){P(z,`/videos?q=${Y(_.value)}&view=${i.value}`)}function re(){i.value==="grid"?i.value="list":i.value="grid"}function _e(){te.push("/files"),Ke(dt,{message:v("upload_videos")})}return qe(()=>{ze.on("refetch_by_tag_type",s=>{s===h&&de()})}),(s,n)=>{const A=lt,$=nt,V=at,pe=ot,me=st,ve=Ze,he=tt,ge=et,fe=Ge;return a(),c(C,null,[e("div",rt,[f(A,{current:()=>`${s.$t("page_title.videos")} (${w.value})`},null,8,["current"]),e("div",_t,[e("button",{type:"button",class:"btn btn-action",onClick:b(re,["prevent"])},[i.value==="list"?(a(),T($,{key:0,class:"bi"})):d("",!0),i.value==="grid"?(a(),T(V,{key:1,class:"bi"})):d("",!0)],8,pt),e("button",{type:"button",class:"btn btn-action",onClick:b(_e,["prevent"])},l(s.$t("upload")),9,mt),i.value==="list"?(a(),T(pe,{key:0,title:s.$t("actions"),items:ce},null,8,["title"])):d("",!0),f(ve,{modelValue:_.value,"onUpdate:modelValue":n[2]||(n[2]=t=>_.value=t),search:K},{filters:De(()=>[e("div",vt,[e("label",ht,l(s.$t("keywords")),1),e("div",gt,[U(e("input",{type:"text","onUpdate:modelValue":n[0]||(n[0]=t=>r.text=t),class:"form-control",onKeyup:Be(Q,["enter"])},null,40,ft),[[Me,r.text]])])]),e("div",bt,[e("label",kt,l(s.$t("tags")),1),e("div",yt,[f(me,{modelValue:r.tags,"onUpdate:modelValue":n[1]||(n[1]=t=>r.tags=t),label:"name","track-by":"id",options:o(R)},null,8,["modelValue","options"])])]),e("div",wt,[e("button",{type:"button",class:"btn",onClick:b(Q,["stop"])},l(s.$t("search")),9,$t)])]),_:1},8,["modelValue"])])]),i.value==="grid"?(a(),c("div",Vt,[(a(!0),c(C,null,q(o(x),(t,F)=>(a(),c("div",{class:"col",onClick:p=>o(M)(F)},[e("img",{class:"image",src:t.src+"&w=200&h=200"},null,8,Ct),e("span",It,l(o(j)(t.duration)),1)],8,Tt))),256))])):d("",!0),i.value==="grid"&&o(x).length===0?(a(),c("div",St,l(s.$t(o(Z)(o(N),o(I).permissions,"WRITE_EXTERNAL_STORAGE"))),1)):d("",!0),i.value==="list"?(a(),c("table",Rt,[e("thead",null,[e("tr",null,[e("th",null,[U(e("input",{class:"form-check-input",type:"checkbox",onChange:n[3]||(n[3]=(...t)=>o(B)&&o(B)(...t)),"onUpdate:modelValue":n[4]||(n[4]=t=>Ne(E)?E.value=t:null)},null,544),[[X,o(E)]])]),xt,Et,e("th",null,l(s.$t("name")),1),e("th",null,l(s.$t("tags")),1),e("th",null,l(s.$t("duration")),1),e("th",null,l(s.$t("file_size")),1)])]),e("tbody",null,[(a(!0),c(C,null,q(u.value,(t,F)=>(a(),c("tr",{key:t.id,class:Le({checked:t.checked}),onClick:b(p=>t.checked=!t.checked,["stop"])},[e("td",null,[U(e("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":p=>t.checked=p},null,8,Ft),[[X,t.checked]])]),e("td",null,[f(he,{id:t.id,raw:t},null,8,["id","raw"])]),e("td",null,[e("img",{class:"img-video",src:o(J)(t.fileId)+"&w=200&h=200",width:"50",height:"50",onClick:b(p=>o(M)(F),["stop"])},null,8,Ut)]),e("td",null,l(t.title),1),e("td",null,[(a(!0),c(C,null,q(t.tags,p=>(a(),c("span",qt,l(p.name),1))),256))]),e("td",null,l(o(j)(t.duration)),1),e("td",null,l(o(Qe)(t.size)),1)],10,At))),128))]),u.value.length?d("",!0):(a(),c("tfoot",zt,[e("tr",null,[e("td",Dt,[e("div",Mt,l(s.$t(o(Z)(o(N),o(I).permissions,"WRITE_EXTERNAL_STORAGE"))),1)])])]))])):d("",!0),w.value>y?(a(),T(ge,{key:3,modelValue:g.value,"onUpdate:modelValue":n[5]||(n[5]=t=>g.value=t),total:w.value,limit:y},null,8,["modelValue","total"])):d("",!0),f(fe,{visible:o(se),index:o(oe),sources:o(x),onHide:o(ne)},null,8,["visible","index","sources","onHide"])],64)}}});const es=je(Bt,[["__scopeId","data-v-607dc250"]]);export{es as default};
