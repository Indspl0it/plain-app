import{_ as K}from"./TagFilter.vuevuetypescriptsetuptruelang-43b019a0.js";import{_ as P}from"./Dropdown.vuevuetypescriptsetuptruelang-24c50f04.js";import{d as Q,r as N,U as C,bV as j,a0 as U,C as X,a1 as Y,o as k,Q as J,v as g,b as a,f as m,J as S,N as W,L as Z,g as e,K as H,a2 as ee,u as te,p as G,n as I,i as se,t as V,bW as ae,X as L,bX as ne,bY as oe,bZ as ie,b_ as le,c as w,j as re,e as p,F as D,y as de,w as R,x as B,z as A,R as ce,b$ as ue,q as pe}from"./index-400f4a7b.js";import{k as E,b as me,p as _e,d as fe}from"./search-e9047456.js";import{_ as ve}from"./EditValueModal.vuevuetypescriptsetuptruelang-ccce301d.js";import{c as be}from"./index-074527a8.js";import{_ as he}from"./DeleteConfirm.vuevuetypescriptsetuptruelang-b4ebfb77.js";import{_ as $e}from"./VModal.vuevuetypescriptsetuptruelang-610de861.js";import{u as ye,a as Fe}from"./vee-validate.esm-5d9cc34a.js";import{g as T,M as xe}from"./splitpanes.es-a783b760.js";import"./baseIndexOf-70b929c6.js";const ke={class:"mb-4"},ge=["placeholder"],Ce=["disabled"],we=Q({__name:"FeedModal",props:{data:{type:Object}},setup(_){var b;const s=_,{handleSubmit:f}=ye(),l=N(),{mutate:r,loading:$,onDone:v}=C({document:j,appApi:!0}),{value:i,errorMessage:u}=Fe("inputValue",U().required());i.value=((b=s.data)==null?void 0:b.name)??"",(async()=>{var n;await X(),(n=l.value)==null||n.focus()})();const d=f(()=>{var n;r({id:(n=s.data)==null?void 0:n.id,name:i.value})});return v(()=>{Y()}),(n,c)=>{const M=$e;return k(),J(M,{title:n.$t("update_subscription")},{body:g(()=>{var h;return[a("div",ke,m((h=_.data)==null?void 0:h.url),1),a("div",null,[S(a("input",{ref_key:"input",ref:l,type:"text",placeholder:n.$t("name"),class:"form-control","onUpdate:modelValue":c[0]||(c[0]=y=>W(i)?i.value=y:null),onKeyup:c[1]||(c[1]=Z((...y)=>e(d)&&e(d)(...y),["enter"]))},null,40,ge),[[H,e(i)]]),S(a("div",{class:"invalid-feedback"},m(e(u)?n.$t(e(u)):""),513),[[ee,e(u)]])])]}),action:g(()=>[a("button",{type:"button",disabled:e($),class:"btn",onClick:c[2]||(c[2]=(...h)=>e(d)&&e(d)(...h))},m(n.$t("save")),9,Ce)]),_:1},8,["title"])}}}),Me={class:"nav-title mt-4"},Le={class:"nav"},Ne=["onClick","onContextmenu"],Ae=Q({__name:"FeedFilter",props:{selected:{type:String,required:!0}},setup(_){const{t:s}=te(),f=G(),l=N([]),r=N(),$=I(),v=[{text:s("add_subscription"),click:d},{text:s("import_opml_file"),click:h},{text:s("export_opml_file"),click:y}],{refetch:i}=se({handle:(t,o)=>{o?V(s(o),"error"):t&&(l.value=t.feeds)},document:ae,appApi:!0});function u(t){const o=t.target.files;if(!o)return;const F=new FileReader;F.addEventListener("load",()=>{c({content:F.result})},!1),F.readAsText(o[0])}function d(){L(ve,{title:s("add_subscription"),placeholder:s("rss_url"),mutation:()=>C({document:ne,options:{update:()=>{i()}},appApi:!0}),getVariables:t=>({url:t})})}const{mutate:b,onDone:n}=C({document:oe,appApi:!0});n(t=>{ie(t.data.exportFeeds,"application/xml","feeds.xml")});const{mutate:c,onDone:M}=C({document:le,appApi:!0});M(()=>{V(s("imported")),i()});function h(){r.value.value="",r.value.click()}function y(){b()}function O(t){const o=me([{name:"feed",op:"",value:E(t.name)}]);A(f,`/feeds?q=${ce(o)}`)}function z(t,o){t.preventDefault(),be({x:t.x,y:t.y,items:[{label:s("edit"),onClick:()=>{L(we,{data:o})}},{label:s("delete"),onClick:()=>{L(he,{id:o.id,name:o.name,gql:ue,appApi:!0,typeName:"Feed",done:()=>{A(f,"/feeds")}})}}]})}return(t,o)=>{const F=P;return k(),w(D,null,[a("h2",Me,[re(m(t.$t("subscriptions"))+" ",1),p(F,{class:"dropdown-sm",title:t.$t("add"),items:v},null,8,["title"])]),a("ul",Le,[(k(!0),w(D,null,de(l.value,x=>(k(),w("li",{onClick:R(q=>O(x),["prevent"]),onContextmenu:q=>z(q,x),class:B({active:e($).params.feedId===x.id||_.selected&&e(E)(x.name)===_.selected})},m(x.name),43,Ne))),256))]),a("input",{ref_key:"fileInput",ref:r,style:{display:"none"},accept:".xml",type:"file",onChange:u},null,544)],64)}}}),Qe={class:"page-container container-fluid"},qe={class:"sidebar"},Se={class:"nav-title"},Ve={class:"nav"},De=["onClick"],Ee={class:"main"},Te={name:"FeedsRoot",inheritAttrs:!1,customOptions:{}},Ye=Q({...Te,setup(_){const s=I(),f=G(),l=_e(s.query),r=fe(s.query);function $(){A(f,"/feeds")}return(v,i)=>{const u=Ae,d=K,b=pe("router-view");return k(),w("div",Qe,[p(e(xe),null,{default:g(()=>[p(e(T),{size:"20"},{default:g(()=>[a("div",qe,[a("h2",Se,m(v.$t("page_title.feeds")),1),a("ul",Ve,[a("li",{onClick:R($,["prevent"]),class:B({active:e(s).path==="/feeds"&&!e(l)&&!e(r)})},m(v.$t("all")),11,De)]),p(u,{selected:e(r)},null,8,["selected"]),p(d,{"tag-type":"FEED_ENTRY",selected:e(l)},null,8,["selected"])])]),_:1}),p(e(T),null,{default:g(()=>[a("div",Ee,[p(b)])]),_:1})]),_:1})])}}});export{Ye as default};
