import{d as V,ad as S,o as h,c as T,b as v,w as A,x as F,g as c,F as U,y as O,f as y,r as k,bN as G,J as C,e as I,L as H,bw as K,a0 as M,_ as j,u as b,bO as Q,U as D,bP as J,I as w,t as q,$ as B,Q as N,v as $,N as Z,bQ as X,i as W,br as Y,X as x}from"./index-3c761cf5.js";import{_ as E}from"./VModal.vuevuetypescriptsetuptruelang-d5392689.js";import{_ as z}from"./Multiselect-072cb44d.js";import{u as R,a as L}from"./vee-validate.esm-7f7a9a56.js";import{c as ee,k as te}from"./search-2c6de17f.js";const se={class:"pagination"},ae=["onClick"],ne={key:0,class:"page-link"},oe=["onClick"],le=["onClick"],Me=V({__name:"VPagination",props:{total:{type:Number,default:0},limit:{type:Number,default:50},rangeSize:{type:Number,default:2},modelValue:{type:Number,default:0}},emits:["update:modelValue"],setup(l,{emit:n}){const s=l;function r(t){n("update:modelValue",t)}const e=S(()=>Math.ceil(s.total/s.limit)),a=S(()=>{const t=[],o=5+s.rangeSize*2;let i=e.value<=o?1:s.modelValue-s.rangeSize,d=e.value<=o?e.value:s.modelValue+s.rangeSize;if(d=d>e.value?e.value:d,i=i<1?1:i,e.value>o){const _=i-1<3,P=e.value-d<3;if(_){d=o-2;for(let g=1;g<i;g++)t.push(g)}else t.push(1),t.push(null);if(P){i=e.value-(o-3);for(let g=i;g<=e.value;g++)t.push(g)}else{for(let g=i;g<=d;g++)t.push(g);t.push(null),t.push(e.value)}}else for(let _=i;_<=d;_++)t.push(_);return t}),p=S(()=>s.modelValue>1),f=S(()=>s.modelValue<e.value);function m(){p.value&&n("update:modelValue",s.modelValue-1)}function u(){f.value&&n("update:modelValue",s.modelValue+1)}return(t,o)=>(h(),T("ul",se,[v("li",{class:F(["page-item",{disabled:!c(p)}])},[v("a",{class:"page-link",href:"#",onClick:A(m,["prevent"])},"«",8,ae)],2),(h(!0),T(U,null,O(c(a),i=>(h(),T("li",{class:F(["page-item",{disabled:i===null,active:i===l.modelValue}])},[i===null?(h(),T("span",ne,"···")):(h(),T("a",{key:1,class:"page-link",href:"#",onClick:A(d=>r(i),["prevent"])},y(i),9,oe))],2))),256)),v("li",{class:F(["page-item",{disabled:!c(f)}])},[v("a",{class:"page-link",href:"#",onClick:A(u,["prevent"])},"»",8,le)],2)]))}}),ie={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},re=v("path",{fill:"currentColor",d:"M4 19q-.425 0-.713-.288T3 18q0-.425.288-.713T4 17h4q.425 0 .713.288T9 18q0 .425-.288.713T8 19H4ZM4 7q-.425 0-.713-.288T3 6q0-.425.288-.713T4 5h8q.425 0 .713.288T13 6q0 .425-.288.713T12 7H4Zm8 14q-.425 0-.713-.288T11 20v-4q0-.425.288-.713T12 15q.425 0 .713.288T13 16v1h7q.425 0 .713.288T21 18q0 .425-.288.713T20 19h-7v1q0 .425-.288.713T12 21Zm-4-6q-.425 0-.713-.288T7 14v-1H4q-.425 0-.713-.288T3 12q0-.425.288-.713T4 11h3v-1q0-.425.288-.713T8 9q.425 0 .713.288T9 10v4q0 .425-.288.713T8 15Zm4-2q-.425 0-.713-.288T11 12q0-.425.288-.713T12 11h8q.425 0 .713.288T21 12q0 .425-.288.713T20 13h-8Zm4-4q-.425 0-.713-.288T15 8V4q0-.425.288-.713T16 3q.425 0 .713.288T17 4v1h3q.425 0 .713.288T21 6q0 .425-.288.713T20 7h-3v1q0 .425-.288.713T16 9Z"},null,-1),ue=[re];function ce(l,n){return h(),T("svg",ie,ue)}const de={name:"material-symbols-tune-rounded",render:ce},pe={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},me=v("path",{fill:"currentColor",d:"m18.9 20.3l-5.6-5.6q-.75.6-1.725.95T9.5 16q-2.725 0-4.612-1.888T3 9.5q0-2.725 1.888-4.612T9.5 3q2.725 0 4.612 1.888T16 9.5q0 1.1-.35 2.075T14.7 13.3l5.625 5.625q.275.275.275.675t-.3.7q-.275.275-.7.275t-.7-.275ZM9.5 14q1.875 0 3.188-1.313T14 9.5q0-1.875-1.313-3.188T9.5 5Q7.625 5 6.312 6.313T5 9.5q0 1.875 1.313 3.188T9.5 14Z"},null,-1),_e=[me];function ve(l,n){return h(),T("svg",pe,_e)}const fe={name:"material-symbols-search-rounded",render:ve},ge={class:"search-input"},he=["value","placeholder"],Te={class:"dropdown-menu search-panel"},ye=V({__name:"SearchInput",props:{modelValue:{type:String,default:""},search:{type:Function,required:!0}},emits:["update:modelValue"],setup(l,{emit:n}){const s=l,r=k(!1),e=k(null),a=k(!1),p=m=>{n("update:modelValue",m.target.value)};function f(){r.value=!0}return(m,u)=>{const t=fe,o=de,i=G("click-away");return C((h(),T("div",ge,[I(t,{class:"bi bi-search"}),v("input",{ref_key:"inputRef",ref:e,type:"search","data-search-input":"true",value:l.modelValue,onInput:p,onFocus:f,onBlur:u[0]||(u[0]=d=>r.value=!1),onKeyup:u[1]||(u[1]=H((...d)=>s.search&&s.search(...d),["enter"])),placeholder:m.$t("search_hint")},null,40,he),I(o,{class:"bi bi-tune",onClick:u[2]||(u[2]=A(()=>a.value=!a.value,["prevent"]))}),C(v("div",Te,[K(m.$slots,"filters",{},void 0,!0)],512),[[M,a.value]])])),[[i,()=>a.value=!1]])}}});const De=j(ye,[["__scopeId","data-v-7e30f9f7"]]),be=["disabled"],qe=V({__name:"AddToTagsModal",props:{tagType:{type:String,required:!0},tags:{type:Array,default:()=>[]},items:{type:Array,default:()=>[]}},setup(l){const n=l,{handleSubmit:s}=R(),{t:r}=b(),{value:e,errorMessage:a}=L("selectedTags",Q().test("required",()=>"valid.required",t=>t.length),{initialValue:[]}),{mutate:p,loading:f,onDone:m}=D({document:J,appApi:!0});m(()=>{n.tagType==="AUDIO"&&w.emit("refetch_app"),w.emit("refetch_by_tag_type",n.tagType),q(r("saved")),B()});const u=s(()=>{p({tagType:n.tagType,tagIds:e.value.map(t=>t.id),items:n.items})});return(t,o)=>{const i=z,d=E;return h(),N(d,{title:t.$t("add_to_tags")},{body:$(()=>[I(i,{modelValue:c(e),"onUpdate:modelValue":o[0]||(o[0]=_=>Z(e)?e.value=_:null),label:"name","track-by":"id",options:l.tags},null,8,["modelValue","options"]),C(v("div",{class:"invalid-feedback"},y(c(a)?t.$t(c(a)):""),513),[[M,c(a)]])]),action:$(()=>[v("button",{type:"button",disabled:c(f),class:"btn",onClick:o[1]||(o[1]=(..._)=>c(u)&&c(u)(..._))},y(t.$t("save")),9,be)]),_:1},8,["title"])}}}),ke=["disabled"],$e=V({__name:"RemoveFromTagsModal",props:{tagType:{type:String,required:!0},tags:{type:Array,default:()=>[]},ids:{type:Array,default:()=>[]}},setup(l){const n=l,{handleSubmit:s}=R(),{t:r}=b(),{value:e,errorMessage:a}=L("selectedTags",Q().test("required",()=>"valid.required",t=>t.length),{initialValue:[]}),{mutate:p,loading:f,onDone:m}=D({document:X,appApi:!0});m(()=>{n.tagType==="AUDIO"&&w.emit("refetch_app"),w.emit("refetch_by_tag_type",n.tagType),q(r("saved")),B()});const u=s(()=>{p({tagIds:e.value.map(t=>t.id),keys:n.ids})});return(t,o)=>{const i=z,d=E;return h(),N(d,{title:t.$t("remove_from_tags")},{body:$(()=>[I(i,{modelValue:c(e),"onUpdate:modelValue":o[0]||(o[0]=_=>Z(e)?e.value=_:null),label:"name","track-by":"id",options:l.tags},null,8,["modelValue","options"]),C(v("div",{class:"invalid-feedback"},y(c(a)?t.$t(c(a)):""),513),[[M,c(a)]])]),action:$(()=>[v("button",{type:"button",disabled:c(f),class:"btn",onClick:o[1]||(o[1]=(..._)=>c(u)&&c(u)(..._))},y(t.$t("save")),9,ke)]),_:1},8,["title"])}}}),Be=(l,n,s)=>{const{t:r}=b();return{addToTags:()=>{const e=n.value.filter(a=>a.checked);if(e.length===0){q(r("select_first"),"error");return}x(qe,{tagType:l,tags:s.value,items:e.map(a=>({key:a.id,title:a.title,size:a.size}))})}}},Ne=(l,n,s)=>{const{t:r}=b();return{removeFromTags:()=>{const e=n.value.filter(a=>a.checked);if(e.length===0){q(r("select_first"),"error");return}x($e,{tagType:l,tags:s.value,ids:e.map(a=>a.id)})}}},xe=(l,n,s,r)=>{const e=k([]),{t:a}=b();return W({handle:async(p,f)=>{if(f)q(a(f),"error");else if(p){e.value=p.tags;const m=ee(n.value);s.tags=[];const u=[];m.forEach(o=>{if(o.name==="text")s.text=o.value;else if(o.name==="tag"){const i=p.tags.find(d=>te(d.name)===o.value);i?(s.tags.push(i),u.push(i.id)):u.push("invalid")}});const t=[...m].filter(o=>o.name!=="tag");u.forEach(o=>{t.push({name:"tag_id",op:"",value:o})}),r(t)}},document:Y,variables:{type:l},appApi:!0}),{tags:e}},Ve=["disabled"],Se=V({__name:"DeleteItemsConfirm",props:{gql:{type:Object,required:!0},done:{type:Function,required:!0},variables:{type:Function,required:!0}},setup(l){const n=l,{mutate:s,loading:r,onDone:e}=D({document:n.gql,appApi:!0});function a(){s(n.variables())}return e(()=>{n.done(),B()}),(p,f)=>{const m=E;return h(),N(m,{class:"delete-modal",title:p.$t("confirm_to_delete")},{action:$(()=>[v("button",{type:"button",disabled:c(r),class:"btn",onClick:a},y(p.$t("delete")),9,Ve)]),_:1},8,["title"])}}}),Ee=l=>{const n=k(!1);function s(){n.value?l.value.forEach(r=>{r.checked=!0}):l.value.forEach(r=>{r.checked=!1})}return{selectAll:n,toggleSelect:s}},Qe=(l,n,s)=>{const{t:r}=b();return{deleteItems:()=>{const e=s.value.filter(a=>a.checked);if(e.length===0){q(r("select_first"),"error");return}x(Se,{gql:l,variables:()=>({ids:e.map(a=>a.id)}),done:n})}}};export{De as _,Be as a,Ne as b,Ee as c,Me as d,Qe as e,Se as f,xe as u};
