import{u as tt,a as et,b as ot,e as st,c as at,_ as nt,d as lt}from"./list-e7ef4cf1.js";import{_ as ct}from"./FieldId-da304ce7.js";import{_ as it}from"./Multiselect-90c04a89.js";import{_ as ut}from"./Dropdown.vuevuetypescriptsetuptruelang-172ac0f4.js";import{_ as dt}from"./Breadcrumb-23f5606f.js";import{d as rt,n as pt,r as p,u as _t,A as mt,m as ht,B as ft,C as vt,aH as gt,D as bt,t as kt,aI as yt,G as $t,H as Ct,I as wt,o as c,c as d,a as t,b as _,w as b,e as a,q as Vt,J as C,K as Tt,L as At,j as n,M as U,N as It,F as w,v as M,s as St,P as x,g as F,Q as qt,x as K,R as L,aJ as N}from"./index-89decb33.js";import{b as Dt,a as Bt}from"./search-0684184d.js";import{n as Qt}from"./list-6498ebd9.js";import{t as Ut}from"./truncate-37978bbb.js";import"./VModal.vuevuetypescriptsetuptruelang-6d140002.js";import"./vee-validate.esm-09f61400.js";import"./baseIndexOf-70b929c6.js";import"./stringToArray-ce29ac4f.js";import"./toInteger-3fab7e5d.js";const Mt={class:"v-toolbar"},xt={class:"right-actions"},Ft=["onClick"],Kt={class:"row mb-3"},Lt={class:"col-md-3 col-form-label"},Nt={class:"col-md-9"},Rt=["onKeyup"],Gt={class:"row mb-3"},Ht={class:"col-md-3 col-form-label"},Pt={class:"col-md-9"},zt={class:"actions"},Jt=["onClick"],jt={class:"table"},Et=t("th",null,"ID",-1),Ot=["onClick"],Wt=["onUpdate:modelValue"],Xt=["onClick"],Yt={class:"badge"},Zt={class:"nowrap"},te={class:"nowrap"},ee={key:0},oe={colspan:"6"},se={class:"no-data-placeholder"},ke=rt({__name:"AIChatsView",setup(ae){var B,Q;const V=pt(),l=p([]),{t:m}=_t(),i=mt({text:"",tags:[]}),h="AI_CHAT",T=ht().query,f=p(parseInt(((B=T.page)==null?void 0:B.toString())??"1")),v=50,g=p(0),u=p(ft(((Q=T.q)==null?void 0:Q.toString())??"")),A=p(""),{tags:k}=tt(h,u,i,async o=>{o.push({name:"parent_id",op:"",value:""}),A.value=Dt(o),await vt(),J()}),{addToTags:R}=et(h,l,k),{removeFromTags:G}=ot(h,l,k),{deleteItems:H}=st(gt,()=>{S()},l),P=[{text:m("add_to_tags"),click:R},{text:m("remove_from_tags"),click:G},{text:m("delete"),click:H}],{selectAll:y,toggleSelect:I}=at(l),{loading:z,load:J,refetch:S}=bt({handle:(o,s)=>{s?kt(m(s),"error"):o&&(l.value=o.aiChats.map($=>({...$,checked:!1})),g.value=o.aiChatCount)},document:yt,variables:()=>({offset:(f.value-1)*v,limit:v,query:A.value}),appApi:!0});$t(f,o=>{K(V,`/aichats?page=${o}&q=${L(u.value)}`)});function q(){u.value=Bt(i),D()}function D(){K(V,`/aichats?q=${L(u.value)}`)}Ct(()=>{wt.on("refetch_by_tag_type",o=>{o===h&&S()})});function j(o){N(`/aichats/${o.id}`)}function E(){N("/aichats/create")}return(o,s)=>{const $=dt,O=ut,W=it,X=nt,Y=ct,Z=lt;return c(),d(w,null,[t("div",Mt,[_($,{current:()=>`${o.$t("page_title.aichats")} (${g.value})`},null,8,["current"]),t("div",xt,[t("button",{class:"btn btn-action",type:"button",onClick:b(E,["prevent"])},a(o.$t("new_chat")),9,Ft),_(O,{title:o.$t("actions"),items:P},null,8,["title"]),_(X,{modelValue:u.value,"onUpdate:modelValue":s[2]||(s[2]=e=>u.value=e),search:D},{filters:Vt(()=>[t("div",Kt,[t("label",Lt,a(o.$t("keywords")),1),t("div",Nt,[C(t("input",{type:"text","onUpdate:modelValue":s[0]||(s[0]=e=>i.text=e),class:"form-control",onKeyup:At(q,["enter"])},null,40,Rt),[[Tt,i.text]])])]),t("div",Gt,[t("label",Ht,a(o.$t("tags")),1),t("div",Pt,[_(W,{modelValue:i.tags,"onUpdate:modelValue":s[1]||(s[1]=e=>i.tags=e),label:"name","track-by":"id",options:n(k)},null,8,["modelValue","options"])])]),t("div",zt,[t("button",{type:"button",class:"btn",onClick:b(q,["stop"])},a(o.$t("search")),9,Jt)])]),_:1},8,["modelValue"])])]),t("table",jt,[t("thead",null,[t("tr",null,[t("th",null,[C(t("input",{class:"form-check-input",type:"checkbox",onChange:s[3]||(s[3]=(...e)=>n(I)&&n(I)(...e)),"onUpdate:modelValue":s[4]||(s[4]=e=>It(y)?y.value=e:null)},null,544),[[U,n(y)]])]),Et,t("th",null,a(o.$t("content")),1),t("th",null,a(o.$t("tags")),1),t("th",null,a(o.$t("updated_at")),1),t("th",null,a(o.$t("created_at")),1)])]),t("tbody",null,[(c(!0),d(w,null,M(l.value,e=>(c(),d("tr",{key:e.id,class:St({checked:e.checked}),onClick:b(r=>e.checked=!e.checked,["stop"])},[t("td",null,[C(t("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":r=>e.checked=r},null,8,Wt),[[U,e.checked]])]),t("td",null,[_(Y,{id:e.id,raw:e},null,8,["id","raw"])]),t("td",null,[t("a",{href:"#",onClick:b(r=>j(e),["stop"])},a(n(Ut)(e.content,{length:200,omission:""})),9,Xt)]),t("td",null,[(c(!0),d(w,null,M(e.tags,r=>(c(),d("span",Yt,a(r.name),1))),256))]),t("td",Zt,a(n(x)(e.updatedAt)),1),t("td",te,a(n(x)(e.createdAt)),1)],10,Ot))),128))]),l.value.length?F("",!0):(c(),d("tfoot",ee,[t("tr",null,[t("td",oe,[t("div",se,a(o.$t(n(Qt)(n(z)))),1)])])]))]),g.value>v?(c(),qt(Z,{key:0,modelValue:f.value,"onUpdate:modelValue":s[5]||(s[5]=e=>f.value=e),total:g.value,limit:v},null,8,["modelValue","total"])):F("",!0)],64)}}});export{ke as default};
